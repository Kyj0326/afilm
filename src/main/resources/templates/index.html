<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap 4</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <style>
       body {
        background-image : url('/file/background.png');
        background-size : cover ;
       }
       @font-face {
            font-family: 'GangwonEdu_OTFBoldA';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2201-2@1.0/GangwonEdu_OTFBoldA.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }
        html {font-family: 'GangwonEdu_OTFBoldA'}

        .container {
            background-image: url(/file/background_2.PNG);
            background-size : cover ;
            border-radius: 2%;
        }
        img#previewImg{cursor:pointer;width=100%;height=100%;display:flex;}

        .filebox {display:flex;justify-content: space-around;}
        .filebox label {display: inline-block; padding: 4px 25px; margin-left:5px; color: #999; font-size: inherit; line-height: normal; vertical-align: middle; border-radius: .25em; cursor: pointer; color: #fff; background-color: #895fc0; border: 1px solid #683d8b;}
        .filebox input[type="file"] {position: absolute;width: 1px;height: 1px;padding: 0;margin: -1px;overflow: hidden;clip:rect(0,0,0,0);border: 0;}
        .filebox .upload-name{display: inline-block; padding: 0.3em 0.4em; font-size: inherit; font-family: inherit; line-height: normal; vertical-align: middle; background-color: #f5f5f5;
                                border: 1px solid #ebebeb; border-bottom-color: #e2e2e2; border-radius: .25em; -webkit-appearance: none; -moz-appearance: none; appearance: none; }
        .card-body {  padding: 0rem;}
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
<span class="badge badge-pill badge-primary text-right" th:text="${user.username} + 님 "></span>
<span class="badge badge-pill badge-primary text-right" th:text="${user.email}"></span>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<div class="container" >


            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#qwe">Step 1 - 기본정보 입력</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#asd">Step 2 - 사진 업로드</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#zxc">Step 3 - 완료</a>
                </li>
            </ul>
            <div class="tab-content">
                <div class="tab-pane fade show active" id="qwe">
                    <br>
                    <div class="row">

                            <video class="col-md-8 order-md-1 mb-4" controls poster="/file/test.png" >

                                <source src="/file/test.mp4" type="video/mp4">
                                <strong>Your browser does not support the video tag.</strong>
                            </video>


                            <div class="col-md-4 order-md-2">
                                <form>
                                    <br>
                                    <br>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="mailName">신랑 이름</label>
                                            <input type="title" class="form-control" id="mailName" name="mailName" placeholder="_ _ _ _"/>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="femaleName">신부 이름 </label>
                                            <input type="title" class="form-control" id="femaleName" name="femaleName" placeholder="_ _ _ _"/>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="info_1">부가 정보1</label>
                                            <input type="title" class="form-control" id="info_1" name="info_1" placeholder="_ _ _ _"/>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="info_1">부가 정보2</label>
                                            <input type="title" class="form-control" id="info_2" name="info_2" placeholder="_ _ _ _"/>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-12 mb-3">
                                            <label for="marryDate" class="col-sm-12 control-label">결혼식 일시</label>
                                            <input type="datetime-local" class="form-control" id="marryDate" name="marryDate" placeholder="_ _ _ _"/>
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary float-right">다음단계</button>
                                </form>
                            </div>

                    </div>



                </div>
                <div class="tab-pane fade" id="asd">
                    <div class="container-">
                        <div id="main_list" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
<!--                            <div class="col">-->
<!--                                <div class="card shadow-sm">-->
<!--                                    <span> 사진 1 </span>-->
<!--                                    <svg class="bd-placeholder-img card-img-top" width="100%" height="10" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Thumbnail" preserveAspectRatio="xMidYMid slice" focusable="false">-->
<!--                                        <img src="/file/afilm_logo.png"  id="previewImg" class="img-thumbnail-1" />-->
<!--                                    </svg>-->

<!--                                    <div class="card-body">-->
<!--                                        <div class="filebox">-->
<!--&lt;!&ndash;                                            <input class="upload-name" disabled="disabled">&ndash;&gt;-->

<!--                                            <label for="file1" class="" >이미지 첨부</label>-->
<!--                                            <input type="file" id="file1" class="upload-hidden" name="file1">-->
<!--                                        </div>-->
<!--&lt;!&ndash;                                        <span> 3초</span>&ndash;&gt;-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->

                    </div>

<!--                    <div class="img-fluid">-->
<!--                        &lt;!&ndash;                        <img class="img-thumbnail" id="previewImg" onclick="popImage(this.src)">&ndash;&gt;-->
<!--                        <img src="/files/afilm_logo.png" id="previewImg" class="img-thumbnail" />-->
<!--                        <div class="filebox">-->
<!--                            <input class="upload-name" disabled="disabled">-->
<!--                            <input type="file" id="file1" class="upload-hidden" name="file1">-->
<!--                            <label for="file1" class="" >이미지 첨부</label>-->
<!--                        </div>-->

<!--                    <div class="container-fluid">-->
<!--                        <div class="form-group col-md-12">-->
<!--&lt;!&ndash;                        <img class="img-thumbnail" id="previewImg" onclick="popImage(this.src)">&ndash;&gt;-->
<!--                      <img src="/files/afilm_logo.png" id="previewImg" class="img-thumbnail" />-->
<!--                       <div class="filebox text-center">-->
<!--                           <input class="upload-name" disabled="disabled">-->
<!--                           <input type="file" id="file1" class="upload-hidden" name="file1">-->
<!--                           <label for="file1" class="" >이미지 첨부</label>-->
<!--                       </div>-->
<!--                    </div>-->
<!--                        <div class="form-group col-md-12">-->
<!--                            &lt;!&ndash;                        <img class="img-thumbnail" id="previewImg" onclick="popImage(this.src)">&ndash;&gt;-->
<!--                            <img src="/files/afilm_logo.png"  id="previewImg" class="img-thumbnail" />-->
<!--                            <div class="filebox">-->
<!--                                <input class="upload-name" disabled="disabled">-->
<!--                                <input type="file" id="file1" class="upload-hidden" name="file1">-->
<!--                                <label for="file1" >이미지 첨부</label>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->

<!--                        <div class="uploadImg">-->
<!--                            &lt;!&ndash;                        <img class="img-thumbnail" id="previewImg" onclick="popImage(this.src)">&ndash;&gt;-->
<!--                            <img src="/files/afilm_logo.png"  id="previewImg" class="img-thumbnail" />-->
<!--                            <div class="filebox">-->
<!--                                <input class="upload-name" disabled="disabled">-->
<!--                                <input type="file" id="file1" class="upload-hidden" name="file1">-->
<!--                                <label for="file1" >이미지 첨부</label>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    <div class="uploadImg">-->
<!--                        <img class="img-thumbnail" id="previewImg" onclick="popImage(this.src)">-->
<!--                        <div class="filebox">-->
<!--                            <input class="upload-name" disabled="disabled">-->
<!--                            <input type="file" id="file1" class="upload-hidden" name="file1">-->
<!--                            <label for="file1">이미지 첨부</label>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="uploadImg">-->
<!--                        <img class="img-thumbnail" id="previewImg" onclick="popImage(this.src)">-->
<!--                        <div class="filebox">-->
<!--                            <input class="upload-name" disabled="disabled">-->
<!--                            <input type="file" id="file1" class="upload-hidden" name="file1">-->
<!--                            <label for="file1">이미지 첨부</label>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="uploadImg">-->
<!--                        <img class="img-thumbnail" id="previewImg" onclick="popImage(this.src)">-->
<!--                        <div class="filebox">-->
<!--                            <input class="upload-name" disabled="disabled">-->
<!--                            <input type="file" id="file1" class="upload-hidden" name="file1">-->
<!--                            <label for="file1">이미지 첨부</label>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--                </div>-->



<!--                <form th:action="@{/img/upload}" method="post" enctype="multipart/form-data">-->
<!--                    <div class="row g-3">-->
<!--                        <div class="col-12">-->
<!--                            <label for="text" class="form-label">상품 이미지 업로드</label>-->
<!--                            <input type="file" class="form-control" id="imgFile" name="imgFile">-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <hr class="my-4">-->
<!--                    <button class="w-100 btn btn-primary btn-lg mb-3" type="submit">상품 등록</button>-->
<!--                </form>-->

                <div class="tab-pane fade" id="zxc">
                    <p>Curabitur dignissim quis nunc vitae laoreet. Etiam ut mattis leo, vel fermentum tellus. Sed sagittis rhoncus venenatis. Quisque commodo consectetur faucibus. Aenean eget ultricies justo.</p>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>

<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script>

window.onload = function () {


}
    $(document).ready(function(){

        for(var i=1; i<31; i++){
            var template = ""
            template += "<div class=\"col\">"
                        +  "<div class=\"card shadow-sm\">"
                        +  " <span> 사진 "+i + "</span> "
                        +  "<svg class=\"bd-placeholder-img card-img-top\" width=\"100%\" height=\"10\" xmlns=\"http://www.w3.org/2000/svg\" role=\"img\" aria-label=\"Placeholder: Thumbnail\" preserveAspectRatio=\"xMidYMid slice\" focusable=\"false\">"
                        +  "<img src=\"/file/afilm_logo.png\"  id=\"previewImg-"+i+"\" class=\"img-thumbnail\" />"
                        +  "</svg>"
                        +  "<div class=\"card-body\">"
                        +  "<div class=\"filebox\">"
                        +  "<label for=\"file1\" id=\"addfile-"+i+"\" onclick=\"preview("+i+")\">이미지 첨부</label>"
                        +  "<input type=\"file\" id=\"file"+i+"\" class=\"upload-hidden-"+i+"\" name=\"file\">"
                        +   "</div>"
                        +  "</div>"
                        +  "</div>" ;
               $("#main_list").append(template);
        }
        //파일첨부 이벤트


        $('[class^="addfile"]').each(function(index){
            index.onclick = readImage(index);
        });





        $('[class^="upload-hidden"]').change(function(){

            $('[class^="upload-hidden"]').each(function(){
            console.log("$(this)[0].id : " + $(this)[0].id ) ;
            console.log($(this)[0] ) ;
            console.log($(this)) ;
                 readImage($(this)[0]); //미리보기
            })
         });


        $('[class^="upload-hidden"]').on('change', function(){
            if(window.FileReader){
                var filename = $(this)[0].files[0].name;
                if(!validFileType(filename)){
                    alert("허용하지 않는 확장자 파일입니다.");
                    return false;
                }else{
                    if(!validFileSize($(this)[0].files[0])){
                        alert("파일 사이즈가 10MB를 초과합니다.");
                        return false;
                    }else{
                        if(!validFileNameSize(filename)){
                            alert("파일명이 30자를 초과합니다.");
                            return false;
                        }
                    }
                }
            } else {
                var filename = $(this).val().split('/').pop().split('\\').pop();
            }
            readImage($(this)[0]); //미리보기
        });
    });

    function validFileType(filename) {
        const fileTypes = ["png", "jpg", "jpeg"];
		return fileTypes.indexOf(filename.substring(filename.lastIndexOf(".")+1, filename.length).toLowerCase()) >= 0;
	}

    function validFileSize(file){
        if(file.size > 10000000){ //10MB
            return false;
        }else{
            return true;
        }
    }

    function validFileNameSize(filename){
        if(filename.length > 30){ //30자
            return false;
        }else{
            return true;
        }
    }

    //이미지 띄우기
    function readImage(input) {
	    if(input.files && input.files[0]) {
	        var id = input.id;
	        console.log("id :" + id);
	        console.log("id.substr(5,1) :" + id.substr(4,1));
	        const reader = new FileReader();
	        reader.onload = function(e){
	            const previewImage = document.getElementById("previewImg-"+id.substr(4,1));
	            previewImage.src = e.target.result;
	        }
	        // reader가 이미지 읽도록 하기
	        reader.readAsDataURL(input.files[0]);
	    }
	}

    //이미지 원본 팝업 띄우기
    function popImage(url) {
        var img = new Image();
        img.src = url;
        var img_width = img.width;
        var win_width = img.width + 25;
        var img_height = img.height;
        var win = img.height + 30;
        var popup = window.open('', '_blank', 'width=' + img_width + ', height=' + img_height + ', menubars=no, scrollbars=auto');
        popup.document.write("<style>body{margin:0px;}</style><img src='"+url+"' width='"+win_width+"'>");
    }


</script>
</body>
</html>